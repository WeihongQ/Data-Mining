n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1-pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1-pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1-pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
df = c()
for (n in c(5, 15, 25, 50)){
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1-pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
View(df)
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1-pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
df = c()
for (n in c(5, 15, 25, 50)){
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
df = c()
for (n in c(5, 15, 25, 50)){
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= 1-qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
df = c()
for (n in c(5, 15, 25, 50)){
z= 1-qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
df = c()
for (n in c(5, 15, 25, 50)){
z= 1-qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
df = c()
for (n in c(5, 15, 25, 50)){
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power= 1 - beta
df = cbind(df, power)
}
plot(mu1, df[,1], col="black", type = "l", ylab = "Power", xlab = expression(mu[1]))
lines(mu1, df[,2], col="red", type = 'l')
lines(mu1, df[,3], col="blue", type = 'l')
lines(mu1, df[,4], col="green", type = 'l')
legend("topright",
legend = c("5", "15", "25", "50"),
col=c("black", "red", "blue", "green"), pch = 20, lty=1)
n=28
mu1 = 141
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
n=28
mu1 = 141
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
print(power)
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1 - pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
rm(list=ls())
setwd("/Users/weihong/Desktop/data-science/UR/DSC462/hw3")
mu =124
mu1 = seq(124,190, by=0.001)
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1- pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= 1-qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1- pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1- pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = 1- pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
n=5
z= qnorm(0.95)
cutoff = z*(26/sqrt(n)) + mu
z1 = (cutoff - mu1)/ (26/sqrt(n))
beta = pnorm(z1)
power = 1 - beta
plot(mu1, power, type = "l", ylab = "Power", xlab = expression(mu[1]))
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
n = ((z1*26)/(cutoff-128))^2
mu1 = 141
z = qnorm(0.95)
z1 = qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
n = ((z1*26)/(cutoff-128))^2
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
n = ((z1*26)/(cutoff-128))^2
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
cutoff = z*(26/sqrt(n)) + mu
n = ((z1*26)/(cutoff-128))^2
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
print(z, z1)
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
print(z)
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
print((z, z1))
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
print(z)
print(z1)
pwr.t.test(n=5,d=26,sig.level=.05,alternative="greater")
((z-z1)/4*26)^2
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
print(z)
print(z1)
n = ((z-z1)/4*26)^2
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
n = ((z-z1)/4*26)^2
print(n)
mu1 = 128
z = qnorm(0.95)
z1 = qnorm(0.05)
n = (((z-z1)/4)*26)^2
print(n)
rm(list=ls())
setwd("/Users/weihong/Desktop/data-science/UR/DSC462/hw3")
rm(list=ls())
setwd("/Users/weihong/Desktop/data-science/UR/DSC462/hw3")
read.csv('airbnb.csv')
rm(list=ls())
setwd("/Users/weihong/Desktop/data-science/UR/DSC462/hw3")
airbnb = read.csv('airbnb.csv')
View(airbnb)
full <- subset(airbnb, room_type = 'Entire home')
private <- subset(airbnb, room_type = 'private')
View(full)
full <- subset(airbnb, room_type == 'Entire home')
private <- subset(airbnb, room_type == 'private')
full <- subset(airbnb, room_type == 'Entire home')
private <- subset(airbnb, room_type == 'Private room')
library(ggplot2)
ggplot(df, aes(x=full$price)) + geom_histogram()
library(ggplot2)
ggplot(full, aes(x=full$price)) + geom_histogram()
library(ggplot2)
ggplot(full, aes(x=price)) + geom_histogram()
library(ggplot2)
ggplot(full, aes(x=price)) + geom_histogram(bins=30)
library(ggplot2)
ggplot(full, aes(x=price)) + geom_histogram(bins=30)
ggplot(private, aes(x=price)) + geom_histogram(bins=30)
View(private)
View(full)
print("mean = ", mean(full$price))
print(mean(full$price))
print("standard error = ", sd(full$price))
print("mean = " mean(full$price))
print("mean = ", mean(full$price))
m =  mean(full$price)
print("mean = ",m)
m =  mean(full$price)
cat("mean = ", m)
#print("standard error = ", sd(full$price))
#print("sample size = ", count(full$price))
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
cat("sample size = ", count(full$price))
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
cat("sample size = ", count(full, 'price'))
library(ggplot2)
library(plyr)
ggplot(full, aes(x=price)) + geom_histogram(bins=30)
ggplot(private, aes(x=price)) + geom_histogram(bins=30)
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
cat("sample size = ", count(full, 'price'))
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
size = count(full, 'price')
cat("sample size = ", size)
size
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
size = count(full$price)
cat("sample size = ", size)
cat("mean = ", m =  mean(full$price))
cat("standard error = ", sd(full$price))
cat("sample size = ", ncol(full))
cat("mean = ", m =  mean(full$price) \n)
cat("mean = ", m =  mean(full$price) /n)
cat("mean = ", m =  mean(full$price), \n)
cat("mean = ", m =  mean(full$price), "\n")
cat("standard error = ", sd(full$price))
cat("sample size = ", ncol(full))
cat("mean = ", m =  mean(full$price), "\n")
cat("standard error = ", sd(full$price), "\n")
cat("sample size = ", ncol(full))
cat("mean = ", m =  mean(private$price), "\n")
cat("standard error = ", sd(private$price), "\n")
cat("sample size = ", ncol(private))
cat("mean = ", m =  mean(private$price), "\n")
cat("standard error = ", sd(private$price), "\n")
cat("sample size = ", nrow(private))
cat("mean = ", m =  mean(full$price), "\n")
cat("standard error = ", sd(full$price), "\n")
cat("sample size = ", nrow(full))
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
nu = (s1^2/n1 + s2^2/n2)^2 / ((s1^2/n1)^2/(n1-1) + (s2^2/n2)^2/(n2-1))
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
nu = (s1^2/n1 + s2^2/n2)^2 / ((s1^2/n1)^2/(n1-1) + (s2^2/n2)^2/(n2-1))
2*pt(t,nu)
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
nu = (s1^2/n1 + s2^2/n2)^2 / ((s1^2/n1)^2/(n1-1) + (s2^2/n2)^2/(n2-1))
2*pt(t,nu)
t.test(full$price, private$price, conf.level = 0.05)
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
nu = (s1^2/n1 + s2^2/n2)^2 / ((s1^2/n1)^2/(n1-1) + (s2^2/n2)^2/(n2-1))
2*(1-pt(t,nu))
t.test(full$price, private$price, conf.level = 0.05)
m1 = 258.2593
m2 = 91.92857
s1 = 208.2271
s2 = 49.91005
n1 = 27
n2 =56
t = (m1-m2-0)/(sqrt(s1^2/n1 + s2^2/n2))
nu = (s1^2/n1 + s2^2/n2)^2 / ((s1^2/n1)^2/(n1-1) + (s2^2/n2)^2/(n2-1))
2*(1-pt(t,nu))
rm(list=ls())
setwd("/Users/weihong/Desktop/data-science/UR/DSC462/hw3")
1-pnorm(4)
pchisq(18, 10)
2*pf(86/108,31,47)
rm(list=ls())
setwd('/Users/weihong/Desktop/data-science/UR/Data-Mining/ideology_predict')
library(ggplot2)
library(stargazer)
library(randomForest)
library(patchwork)
library(glmnet)
library(caret)
#read data
cfps <- read.csv('cfps_processed_short.csv')
ideology <- cfps[, 105:107]
#linear regressions
cols1 <- c(3:105)
cols2 <- c(3:104, 106)
cols3 <- c(3:104, 107)
fit1 <- lm(ideology_economic ~., data = cfps[,cols1])
fit2 <- lm(ideology_political ~., data = cfps[,cols2])
fit3 <- lm(ideology_social ~., data = cfps[,cols3])
stargazer(fit1, fit2, fit3, title="Results", align=TRUE)
# Random forest model
## economic ideology
r1 <- c(3:105)
rf1 <- cfps[, r1]
rf1 <- rf1[complete.cases(rf1), ]
randomF_econ<- randomForest(x = rf1[, 1:ncol(rf1)-1],
y = rf1[, ncol(rf1)],
ntree = 100)
print(randomF_econ)
sqrt(0.6003482)
## political ideology
r2 <- c(3:104, 106)
rf2 <- cfps[, r2]
rf2 <- rf2[complete.cases(rf2), ]
randomF_politics<- randomForest(x = rf2[, 1:ncol(rf2)-1],
y = rf2[, ncol(rf2)],
ntree = 100)
print(randomF_politics)
sqrt(7.250126)
## social ideology
r3 <- c(3:104, 107)
rf3 <- cfps[, r3]
rf3 <- rf3[complete.cases(rf3), ]
randomF_social<- randomForest(x = rf3[, 1:ncol(rf3)-1],
y = rf3[, ncol(rf3)],
ntree = 100)
print(randomF_social)
sqrt(0.9497336)
# Random forest
system.time(randomF_econ<- randomForest(x = rf1[, 1:ncol(rf1)-1],
y = rf1[, ncol(rf1)],
ntree = 100))
system.time(randomF_politics<- randomForest(x = rf2[, 1:ncol(rf2)-1],
y = rf2[, ncol(rf2)],
ntree = 100))
system.time(randomF_social<- randomForest(x = rf3[, 1:ncol(rf3)-1],
y = rf3[, ncol(rf3)],
ntree = 100))
